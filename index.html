<!DOCTYPE html>
<html>
	<head>
		<!-- <script src="mint.js" type="text/javascript"></script> -->
		<meta charset="utf-8" />
		<title>UK Cabutan Bertuah</title>		
		<link href="demo.css" rel="stylesheet" />
		<style>
			.crappy-plastic-part-made-in-china {
				background-color: #222;
				height: 3em;
				font-size: 6em;
				overflow: hidden;
			}
			.pad {
                display: flex;
				width: 8.9em;
				margin: 0 auto;
				height: 1.8em;
			}
			ul {
				list-style: none;
				padding: 0;
				margin: -4.25em 0 0 0;
				width: 1.5em;
				height: 12em;
				float: center;
			}
			li {
				height: 2.2em;
				width: 0.9em;
				line-height: 2;
				background-color: #222;
				color: #fff;
				text-align: center;
				cursor: pointer;
				font-size: 2em;
				font-weight: bold;
				font-family: "Helvetica Neue", Arial, sans-serif;
			}
				li.roundabout-in-focus {
					cursor: default;
				}
			li span {
				display: block;
				padding-top: 0em;
			}

			#carbonads-container {
				clear: both;
				margin-top: 1em;
			}
			#carbonads-container .carbonad {
				margin: 0 auto;
			}
			#history-table {
    font-size: 1.7em;
    width: 70%;
    margin: 2em auto;
    text-align: center;
}
#history-table th, #history-table td {
    padding: 0.7em 1.2em;
    text-align: center;
}
h2 {
    text-align: center;
    font-size: 2em;
    margin-top: 2em;
    font-weight: bold;
}
		</style>
	</head>
<body>
<h1>Nombor Bertuah</h1>
	<div class="crappy-plastic-part-made-in-china">
  <div class="pad">
    <ul><li></li></ul>
    <ul id="digit-3">
      <li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li>
    </ul>
    <ul id="digit-2">
      <li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li>
    </ul>
    <ul id="digit-1">
      <li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li>
    </ul>
    <ul id="digit-0">
      <li>0</li><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li>
    </ul>
    <ul><li></li></ul>
  </div>
</div>
<div class="interact">
    <a href="#" id="contribute">Cabutan</a>
    <a href='#' onclick='location.reload(true); return false;'>Set Semula</a>
</div>

<!-- Table untuk paparan nombor yang sudah keluar -->
<h2>Senarai Nombor Yang Sudah Keluar</h2>
<table id="history-table" border="1" style="margin-top:1em;">
    <thead>
        <tr>
            <th>Bil</th>
            <th>Nombor</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
    
<script src="jquery.js"></script>
<script src="jquery.roundabout2.js"></script>
<script src="jquery.roundabout-shapes2.js"></script>
<script src="jquery.easing.js"></script>
<script>
var count = 0,
    clickable = true,
    historyNumbers = []; // Array untuk simpan nombor yang sudah keluar

$(document).ready(function() {
    // Pastikan roundabout hanya pada digit
    $('ul[id^="digit-"]').roundabout({
        shape: "waterWheel"
    });

    $('#contribute').click(function() {
        if (!clickable) {
            return false;
        }
        $('.interact a').fadeTo(100, 0.5);
        clickable = false;

        // Cari nombor rawak yang belum pernah keluar
        // Ubah 600 kepada 1500 jika mahu maksimum 1500
        if (historyNumbers.length >= 1500) {
            alert("Semua nombor telah dicabut!");
            $('.interact a').fadeTo(100, 1);
            clickable = false;
            return false;
        }
        var maxTry = 2000, tryCount = 0;
        do {
            count = Math.floor((Math.random() * 1500) + 1); // 1 hingga 1500
            tryCount++;
        } while (historyNumbers.indexOf(count) !== -1 && tryCount < maxTry);

        // Animasi digit
        applyCount(count);

        // Simpan nombor ke dalam sejarah dan kemas kini jadual
        historyNumbers.push(count);
        updateHistoryTable();

        return false;
    });

    $('#how-much').click(function() {
        alert('The counter is currently at ' + count + '.');
        return false;
    });
});

// Fungsi untuk kemas kini jadual sejarah (4 digit)
function updateHistoryTable() {
    var tbody = $('#history-table tbody');
    tbody.empty();
    for (var i = 0; i < historyNumbers.length; i++) {
        var num = historyNumbers[i].toString().padStart(4, '0');
        tbody.append('<tr><td>' + (i + 1) + '</td><td>' + num + '</td></tr>');
    }
}

// Fungsi untuk animasi digit (4 digit)
function applyCount(total) {
    var str = total.toString().padStart(4, '0');
    for (var i = 0; i < 4; i++) {
        var part = parseInt(str[i], 10);
        var $ul = $('#digit-' + (3 - i));
        if ($ul.length && $ul.data('roundabout')) {
            var child = $ul.data('roundabout').childInFocus;
            var factor = (part < child) ? (10 + part) - child : part - child;
            var distance = factor * 36;
            if (i < 3) {
                $ul.roundabout('animateToDelta', -distance);
            } else {
                $ul.roundabout('animateToDelta', -distance, function() {
                    $('.interact a').fadeTo(100, 1);
                    clickable = true;
                });
            }
        }
    }
}

console.log('jQuery:', typeof $);
console.log('Roundabout:', typeof $.fn.roundabout);
</script>

</body>
</html>